<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ assets_href }}/manual.css" />
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // すべてのpreタグにコピーボタンを追加
      document.querySelectorAll('.manual-content pre').forEach(function(pre) {
        const button = document.createElement('button');
        button.className = 'code-copy-btn';
        button.textContent = 'コピー';

        button.addEventListener('click', function() {
          const code = pre.querySelector('code');
          const text = code ? code.textContent : pre.textContent;

          navigator.clipboard.writeText(text).then(function() {
            button.textContent = 'コピー完了！';
            button.classList.add('copied');

            setTimeout(function() {
              button.textContent = 'コピー';
              button.classList.remove('copied');
            }, 2000);
          }).catch(function(err) {
            console.error('コピー失敗:', err);
            button.textContent = 'エラー';
          });
        });

        pre.appendChild(button);
      });

      // ナビゲーショントグル機能
      const navToggle = document.getElementById('navToggle');
      const manualLayout = document.getElementById('manualLayout');
      const manualNav = document.getElementById('manualNav');

      if (navToggle && manualLayout && manualNav) {
        navToggle.addEventListener('click', function() {
          manualLayout.classList.toggle('nav-collapsed');
          navToggle.classList.toggle('active');
        });
      }
    });
  </script>
</head>
<body>
  <header class="manual-header">
    <div class="header-text">
      <h1>{{ title }}</h1>
      {{ subtitle_block }}
      <dl class="manual-meta">
        <div>
          <dt>最終更新</dt>
          <dd>{{ generated_on }}</dd>
        </div>
      </dl>
    </div>
  </header>
  <button class="nav-toggle" id="navToggle" aria-label="目次を開閉">☰</button>
  <div class="manual-layout" id="manualLayout">
    <aside class="manual-nav" id="manualNav">
      {{ toc }}
    </aside>
    <main class="manual-content">
      {{ content }}
    </main>
  </div>
  <footer class="manual-footer">
    <p>このドキュメントは自動生成されました。元ファイルを更新した際は <code>python tools/build_manual.py</code> を再実行してください。</p>
  </footer>
</body>
</html>
